<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/html;charset=UTF-8" http-equiv="Content-Type"/>
    <title>Create a modal</title>

    <script type="text/javascript" src="vendor/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="vendor/underscore.js"></script>
    <script type="text/javascript" src="vendor/backbone.js"></script>
    <script type="text/javascript" src="vendor/marionette.js"></script>

    <!-- Adding Backbone.Modal extension here -->
    <link type="text/css" rel="stylesheet" href="vendor/backbone.modal.css">
    <link type="text/css" rel="stylesheet" href="vendor/backbone.modal.theme.css">

    <script type="text/javascript" src="vendor/backbone.modal.js"></script>
    <script type="text/javascript" src="vendor/backbone.marionette.modals.js"></script>

    <!-- Custom style -->
    <link type="text/css" rel="stylesheet" href="style.css">

</head>
<body>
  <a href="#" class="open-1">Open modal</a>

  <div class="app"></div>

  <script type="text/template" id="modals-template">
    <div class="modals-container"></div>
  </script>

  <script type="text/template" id="modal-template1">
    <!-- <div class="bb-modal-titlebar">
    <h2 class="titlebar-title">Manage profiles</h2>
    </div> -->

    <div class="bb-modal-tabbar">
      <ul>
        <li class="tabbar-tab"><a href="#" id="tab1" class="active">Tab 1</a></li>
        <li class="tabbar-tab"><a href="#" id="tab2">Tab 2</a></li>
        <li class="tabbar-tab"><a href="#" id="tab3">Tab 3</a></li>
      </ul>
    </div>

    <div class="my-container">
      
    </div>
    <div class="bb-modal-bottombar">
      <a href="#" class="bb-modal-button">Done</a>
    </div>
  </script>

  <!-- Tab 1 -->
  <script type="text/template" id="modal-view1-template">
    <div class="bb-modal-section">
      <div class="bb-modal-section-info">
        <h3 class="section-title">Credentials</h3>
        <p class="section-description">Please fill in your personal information</h3>
      </div>
      <div class="section-row">
        <label for="username">Username</label>
        <input class="bb-modal-input" type="text" placeholder="Username" id="username"/>
      </div>
      <div class="section-row bb-modal-group">
        <div class="section-column">
          <label for="username">Password</label>
          <input class="bb-modal-input" type="password" placeholder="Password" id="password"/>
        </div>
        <div class="section-column">
          <label for="password-repeat">Password Repeat</label>
          <input class="bb-modal-input" type="password" placeholder="Password repeat" id="password-repeat"/>
        </div>
      </div>
    </div>
  </script>

  <script type="text/template" id="modal-tab1">
    <h2>Tab 1</h2>
    <a href="#" class="open-2">Open second modal</a>
  </script>
  <script type="text/template" id="modal-tab2">
    <h2>Tab 2</h2>
    <p>Some other nice content here.</p>
    <a href="#" class="open-2">Open second modal</a>
  </script>
  <script type="text/template" id="modal-tab3">
    <h2>Tab 3</h2>
    <a href="#" class="open-2">Open second modal</a>
  </script>

  <script type="text/template" id="modal-template2">
    <div class="bb-modal-section">
      <div class="bb-modal-section-info">
        <h3 class="section-title">Credentials</h3>
        <p class="section-description">Please fill in your personal information</h3>
      </div>
      <div class="section-row">
        <label for="username">Username</label>
        <input class="bb-modal-input" type="text" placeholder="Username" id="username"/>
      </div>
      <div class="section-row bb-modal-group">
        <div class="section-column">
          <label for="username">Password</label>
          <input class="bb-modal-input" type="password" placeholder="Password" id="password"/>
        </div>
      </div>
    </div>
    <div class="bb-modal-bottombar">
      <a href="#" class="bb-modal-button">Done</a>
    </div>
  </script>

  <script>
    jQuery(function($) {
      // create a layout class
      var Layout = Backbone.Marionette.Layout.extend({
        template: _.template($('#modals-template').html()),
        regions: {
          modals: {
            selector:   '.modals-container',
            regionType: Backbone.Marionette.Modals
          }  
        }
      });

      // create a modal view class
      var Modal1 = Backbone.Modal.extend({
        template: _.template($('#modal-template1').html()),
        viewContainer: '.my-container',
        submitEl: '.bb-modal-button',
        views: {
          'click #tab1': {
            name: 'tab1',
            view: _.template($('#modal-tab1').html()),
            onActive: 'setActive'
          },
          'click #tab2': {
            name: 'tab2',
            view: _.template($('#modal-tab2').html()),
            onActive: 'setActive'
          },
          'click #tab3': {
            name: 'tab3',
            view: _.template($('#modal-tab3').html()),
            onActive: 'setActive'
          }
        },
        setActive: function(options) {
          this.$('.tabbar-tab a').removeClass('active');
          this.$('#'+options.name).addClass('active');
        },
        onClose: function() {
          console.log('onClose');
        }
      });

      var Modal2 = Backbone.Modal.extend({
        template: _.template($('#modal-template2').html()),
        submitEl: '.bb-modal-button'
      });

      var myLayout = new Layout();
      $('body').append(myLayout.render().el);

      $('body').on('click', '.open-1', function(){
        myLayout.modals.show(new Modal1());
      });

      $('body').on('click', '.open-2', function(){
        myLayout.modals.show(new Modal2());
      });
      
    });
  </script>
</body>
</html>