(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};!function(a,b){return"function"==typeof define&&define.amd?define(["exports","underscore","backbone","backbone.marionette"],b):"object"==typeof exports?b(exports,require("underscore"),require("backbone"),require("backbone.marionette")):a.Backbone.Marionette.Modals=b(a.commonJsStrict={},a._,a.Backbone,a.Backbone.Marionette)}(this,function(b,d,e,f){var g;return g=function(b){function e(){return this.close=a(this.close,this),e.__super__.constructor.apply(this,arguments)}return c(e,b),e.prototype.modals=[],e.prototype.zIndex=0,e.prototype.show=function(a,b){var c,e,g,h,i,j,k,l,m,n;if(this.ensureEl(),this.modals.length>0&&(c=d.last(this.modals),c.modalEl.addClass(""+c.prefix+"-modal--stacked"),g=this.modals[this.modals.length-1],null!=g&&g.modalEl.removeClass(""+g.prefix+"-modal--stacked-reverse")),a.render(b),a.regionEnabled=!0,this.$el.show(),this.$el.append(a.el),this.modals.length>0)for(m=this.modals,i=0,k=m.length;k>i;i++)h=m[i],h.$el.css({background:"none"});for(f.triggerMethod.call(a,"show"),f.triggerMethod.call(this,"show",a),this.currentView=a,n=this.modals,j=0,l=n.length;l>j;j++)e=n[j],e.undelegateModalEvents();return a.on("modal:close",this.close),this.modals.push(a),this.zIndex++},e.prototype.close=function(){var a,b;return b=this.currentView,b&&!b.isClosed?(b.close?b.close():b.remove&&b.remove(),f.triggerMethod.call(b,"close"),f.triggerMethod.call(this,"close",b),b.off("modal:close",this.close),this.modals.splice(d.indexOf(this.modals,b),1),this.zIndex--,this.currentView=this.modals[this.zIndex-1],a=d.last(this.modals),a&&(a.$el.removeAttr("style"),a.modalEl.addClass(""+a.prefix+"-modal--stacked-reverse"),d.delay(function(){return function(){return a.modalEl.removeClass(""+a.prefix+"-modal--stacked")}}(this),300),0!==this.zIndex)?a.delegateModalEvents():void 0):void 0},e.prototype.closeAll=function(){var a,b,c,d,e;for(d=this.modals,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.close());return e},e}(f.Region)})}).call(this);